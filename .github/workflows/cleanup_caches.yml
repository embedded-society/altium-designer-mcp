name: Cleanup GitHub Actions Caches

# Manual trigger only - use when you want to proactively clean up
on:
    workflow_dispatch:
        inputs:
            dry_run:
                description: 'Log actions without deleting (for testing)'
                required: false
                type: boolean
                default: false

jobs:
    cleanup:
        name: Cleanup Caches
        runs-on: ubuntu-latest

        permissions:
            actions: write
            contents: read

        steps:
            - name: Checkout repository
              uses: actions/checkout@de0fac2e4500dabe0009e67214ff5f5447ce83dd # v6.0.2

            - name: Run cleanup script
              uses: actions/github-script@ed597411d8f924073f98dfc5c65a23a2325f34cd # v8.0.0
              env:
                INPUT_DRY_RUN: ${{ inputs.dry_run || false }}
              with:
                script: |
                    const cleanupScript = require('./.github/scripts/cleanup-caches.js');
                    await cleanupScript({ github, context, core });
